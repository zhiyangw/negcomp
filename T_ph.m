function [ T ] = T_ph( p,h,coeff )

if ~exist('coeff','var')
    
coeff = [1.00207; 4.42607; -5.47456; 5.02875; -1.24791; ...
    -2.26162; 4.38441; -1.79088; 3.69276; 5.17644;...
    7.30984; 1.29239; -1.00333; 3.9881; -9.09697; 1.29267; -6.28359; ...
    2.82282; -3.91952; 2.54342; -9.38879];
end

[ rhow_coeff,rhos_coeff,hw_coeff ,hs_coeff] = coeff_to_fun_coeff( coeff );

hconv = 1E4;
pconv = 10;

if h< hw_p(p,hw_coeff)

    T = 273.15-2.41231+2.56222e-8*(h*hconv)-9.31415e-17*(p*pconv).^2-2.2568e-19*(h*hconv).^2;
elseif h>hs_p(p)
    hw = hw_p(p,hw_coeff);
    hs = hs_p(p,hs_coeff);
    a = -2.41231; b = 2.56222e-8; c = -9.31415e-17; d = -2.2568e-19;
	Twhw  = (273.15+a+b*(hw*hconv)+c*(p*pconv).^2+d*(hw*hconv).^2);
	Tshs =	273.15-374.669 + 4.79921e-6*(p*pconv) ...
		-6.33606e-15*(p*pconv).^2 ... 
		+7.39386e-19*(hs*hconv).^2 ...
		-3.3372e34./((hs*hconv*p*pconv).^2) ...
		+3.57154e19./((p*pconv).^3) ...
		-1.1725e-37*p.*pconv.*(hs*hconv).^3 ...
		-2.26861e43./((hs*hconv).^4);
    tempcorr = Twhw - Tshs;
    ts = (273.15-374.669 + 4.79921e-6*(p*pconv) ...
			-6.33606e-15*(p*pconv).^2 ...
			+7.39386e-19*(h*hconv).^2 ...
			-3.3372e34./((h*hconv*p*pconv).^2) ...
			+3.57154e19/((p*pconv).^3) ...
			-1.1725e-37*p*pconv*(h*hconv).^3 ...
			-2.26861e43/((h*hconv).^4));
    T = ts+tempcorr;
    
else
    h = hw_p(p,hw_coeff);
    T = 273.15-2.41231+2.56222e-8*(h*hconv)-9.31415e-17*(p*pconv).^2-2.2568e-19*(h*hconv).^2;
end

end

